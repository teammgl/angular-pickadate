!function(e){"use strict";function t(e,t){for(var a=t.parentNode;null!==a;){if(a===e)return!0;a=a.parentNode}return!1}var a=[].indexOf||function(e){for(var t=0,a=this.length;a>t;t++)if(t in this&&this[t]===e)return t;return-1};e.module("pickadate",[]).provider("pickadateI18n",function(){var e={prev:"prev",next:"next"};this.translations={},this.$get=function(){var t=this.translations;return{t:function(a){return t[a]||e[a]}}}}).factory("pickadateUtils",["$locale",function(t){function a(e){switch(e){case"dd":return"day";case"MM":return"month";case"yyyy":return"year"}}return{parseDate:function(t,n){if(t){if(e.isDate(t))return new Date(t);n=n||"yyyy-MM-dd";var i="(dd|MM|yyyy)",r=n.match(/[-|/]/)[0],s=t.split(r),c=new RegExp([i,i,i].join(r)),l=n.match(c),o={};if(l.shift(),e.forEach(l,function(e,t){o[a(e)]=parseInt(s[t],10)}),!(isNaN(o.year)||isNaN(o.month)||isNaN(o.day)))return new Date(o.year,o.month-1,o.day,3)}},buildDates:function(e,t){var a=[],n=new Date(e.getFullYear(),e.getMonth()+1,0,3);for(t=t||{},e=new Date(e);e.getDay()!==t.weekStartsOn;)e.setDate(e.getDate()-1);for(var i=0;42>i&&!(t.noExtraRows&&e.getDay()===t.weekStartsOn&&e>n);i++)a.push(new Date(e)),e.setDate(e.getDate()+1);return a},buildDayNames:function(e){var a=t.DATETIME_FORMATS.SHORTDAY;if(e){a=a.slice(0);for(var n=0;e>n;n++)a.push(a.shift())}return a}}}]).directive("pickadate",["$locale","$sce","$compile","$document","$window","pickadateUtils","pickadateI18n","dateFilter",function(n,i,r,s,c,l,o,d){var u='<div class="pickadate" ng-show="displayPicker" ng-style="styles"><div class="pickadate-header"><div class="pickadate-controls"><a href="" class="pickadate-prev" ng-click="changeMonth(-1)" ng-show="allowPrevMonth">'+i.trustAsHtml(o.t("prev"))+'</a><a href="" class="pickadate-next" ng-click="changeMonth(1)" ng-show="allowNextMonth">'+i.trustAsHtml(o.t("next"))+'</a></div><h3 class="pickadate-centered-heading">{{currentDate | date:"MMMM yyyy"}}</h3></div><div class="pickadate-body"><div class="pickadate-main"><ul class="pickadate-cell"><li class="pickadate-head" ng-repeat="dayName in dayNames">{{dayName}}</li></ul><ul class="pickadate-cell"><li ng-repeat="d in dates" ng-click="setDate(d)" ng-class="classesFor(d)">{{d.dateObj | date:"d"}}</li></ul></div></div></div>';return{require:"ngModel",scope:{defaultDate:"=",minDate:"=",maxDate:"=",disabledDates:"=",disabledWeekdays:"=",weekStartsOn:"=",onChangeMonth:"&"},link:function(i,o,p,f){function h(){$=l.parseDate(i.minDate,S)||new Date(0),b=l.parseDate(i.maxDate,S)||new Date(99999999999999),T({skipUpdateDate:!0})}function y(){var e=new Date(i.currentDate.getFullYear(),i.currentDate.getMonth(),1,3),t=e.getMonth()+1,a=l.buildDates(e,{weekStartsOn:C,noExtraRows:N}),n=[],r=d(new Date,S),s=new Date(e);s.setMonth(t),i.allowPrevMonth=!$||e>$,i.allowNextMonth=!b||b>=s,i.dayNames=l.buildDayNames(C);for(var c=0;c<a.length;c++){var o=[],u=a[c],p=d(u,S),f=m(p),h=g(u),y=w(u);h||y||f?o.push("pickadate-disabled"):o.push("pickadate-enabled"),y&&o.push("pickadate-outfocus"),f&&o.push("pickadate-unavailable"),p===r&&o.push("pickadate-today"),n.push({date:p,dateObj:u,classNames:o})}i.dates=n}function D(e,t){t=t||{},O?f.$setViewValue(e):f.$setViewValue(e[0]),t.skipRenderInput||o.val(f.$viewValue)}function v(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];m(n)||k(l.parseDate(n,S))||t.push(n)}return t}function w(e){return d(e,"M")!==d(i.currentDate,"M")}function g(e){return $>e||e>b}function k(e){return g(e)||w(e)}function m(e){if(a.call(i.disabledWeekdays||[],i.weekdays[new Date(e).getDay()])>=0)return-1;var t=a.call(i.disabledDates||[],e)>=0;return x&&(t=!t),t}function M(e,t){var n=a.call(t,e);return-1===n?t.push(e):t.splice(n,1),t}var $,b,N=p.hasOwnProperty("noExtraRows"),O=p.hasOwnProperty("multiple"),x=p.hasOwnProperty("invertdisabled"),C=i.weekStartsOn,E=[],R=o[0]instanceof HTMLInputElement,V=r(u)(i),S=(p.format||"yyyy-MM-dd").replace(/m/g,"M");i.displayPicker=!R,i.weekdays=n.DATETIME_FORMATS.DAY,(!e.isNumber(C)||0>C||C>6)&&(C=0),i.setDate=function(e){k(e.dateObj)||m(e.date)||(E=O?M(e.date,E):[e.date],D(E),i.displayPicker=!R)};var T=f.$render=function(t){t=t||{},e.isArray(f.$viewValue)?E=f.$viewValue:f.$viewValue&&(E=[f.$viewValue]),t.skipUpdateDate||(i.currentDate=l.parseDate(i.defaultDate,S)||l.parseDate(E[0],S)||new Date),E=v(E),D(E,t),y()};if(i.classesFor=function(e){var t=a.call(E,e.date)>=0?"pickadate-active":null;return e.classNames.concat(t)},i.changeMonth=function(e){i.currentDate.setDate(1),i.currentDate.setMonth(i.currentDate.getMonth()+e),y(),i.onChangeMonth&&i.onChangeMonth({newMonth:i.currentDate})},i.$watchGroup(["minDate","maxDate"],h),i.$watchCollection("disabledDates",h),i.$watchCollection("disabledWeekdays",h),R){var A=function(e){i.displayPicker=e,i.$apply()};o.on("focus",function(){var e=void 0!==c.pageXOffset,t="CSS1Compat"===(s.compatMode||""),a=e?c.pageXOffset:t?s.documentElement.scrollLeft:s.body.scrollLeft,n=e?c.pageYOffset:t?s.documentElement.scrollTop:s.body.scrollTop,r=c.innerWidth||s.documentElement.clientWidth||s.body.clientWidth;i.styles={top:n+o[0].getBoundingClientRect().bottom+"px"},r-o[0].getBoundingClientRect().left>=300?i.styles.left=a+o[0].getBoundingClientRect().left+"px":i.styles.right=r-o[0].getBoundingClientRect().right-a+"px",A(!0)}),o.on("keydown",function(e){a.call([9,13,27],e.keyCode)>=0&&A(!1)}),i.$watch(function(){return f.$viewValue},function(e){var t=l.parseDate(e,S);t&&T({skipRenderInput:!0}),f.$setValidity("date",!!t)}),s.on("click",function(e){t(V[0],e.target)||e.target===o[0]||A(!1)}),i.$$postDigest(function(){p.value&&(f.$viewValue=p.value,T())}),o.after(V.addClass("pickadate-modal"))}else o.append(V)}}}])}(window.angular);